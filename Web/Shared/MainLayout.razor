@using Shareds.Modeles
@using Web.Services
@inherits LayoutComponentBase

@inject NavigationManager NavigationM

<PageTitle>Web</PageTitle>

<div class="page">
    @if (UserService.userSession is not null)
    {
        <div class="sidebar">
            <NavMenu />
        </div>
    }

    <main>
        <div class="top-row px-4">          
            @if (UserService.userSession is not null)
            {
                <a href="" @onclick="(()=>Logout())">
                    @UserService.userSession.Name
                </a>
            }
            else
            {
                if (UserService.isLoginPage)
                {
                    <button class="btn btn-outline-primary" href="" @onclick="(()=>GoToLogin())">
                        Se connecter
                    </button>
                }
                else
                {
                    <button class="btn btn-outline-primary" href="" @onclick="(()=>GoToRegister())">
                        Créer un compte
                    </button>
                }
            }          
        </div>

        <article class="content px-4">
            @Body
        </article>
    </main>
</div>

@code {
    public int text = 0;

    protected override void OnParametersSet()
    {
        base.OnParametersSet();
    }

    protected override void OnInitialized()
    {

    }

    public void GoToLogin()
    {
        UserService.isLoginPage = false;
        NavigationM.NavigateTo("/login");
    }

    public void GoToRegister()
    {
        UserService.isLoginPage = true;
        NavigationM.NavigateTo("/register");
    }

    public void Test()
    {
        text += 1;

        UserService.userSession = new UserSession(1, "Alpha", "string@string;com", "Admin");
        //userS = UserService.userSession;
        NavigationM.NavigateTo("/dashboard");
    }


    public void Logout()
    {
        UserService.Logout();
        NavigationM.NavigateTo("/");
    }
}
